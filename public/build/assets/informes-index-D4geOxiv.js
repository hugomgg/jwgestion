function e(){let e=$("#periodoFilterCongregacion").val();if(!e)return $("#congregacionStatsContainer").addClass("d-none"),$("#noDataCongregacionMessage").removeClass("d-none"),void $("#loadingCongregacionStats").addClass("d-none");let[o,r]=e.split("-");$("#loadingCongregacionStats").removeClass("d-none"),$("#congregacionStatsContainer").addClass("d-none"),$("#noDataCongregacionMessage").addClass("d-none"),$.ajax({url:window.informesIndexConfig.informeCongregacionRoute,method:"GET",data:{anio:o,mes:r},success:function(e){$("#loadingCongregacionStats").addClass("d-none"),e.success?($("#stat_usuarios_activos").text(e.data.usuarios_activos),$("#stat_usuarios_inactivos").text(e.data.usuarios_inactivos),$("#stat_publicadores").text(e.data.publicadores),$("#stat_estudios_publicadores").text(e.data.estudios_publicadores),$("#stat_precursores_auxiliares").text(e.data.precursores_auxiliares),$("#stat_estudios_precursores_auxiliares").text(e.data.estudios_precursores_auxiliares),$("#stat_precursores_regulares").text(e.data.precursores_regulares),$("#stat_estudios_precursores_regulares").text(e.data.estudios_precursores_regulares),$("#congregacionStatsContainer").removeClass("d-none"),$("#noDataCongregacionMessage").addClass("d-none")):$("#noDataCongregacionMessage").removeClass("d-none").html('<i class="fas fa-exclamation-circle me-2"></i>'+(e.message||"No se pudieron cargar las estadísticas."))},error:function(e){$("#loadingCongregacionStats").addClass("d-none"),$("#noDataCongregacionMessage").removeClass("d-none").html('<i class="fas fa-exclamation-triangle me-2"></i>Error al cargar las estadísticas.')}})}$(document).ready(function(){let e=$("#informesTable").DataTable({responsive:!0,language:{url:"/js/datatables-es-ES.json"},columnDefs:window.informesIndexConfig.datatablesColumnDefs,order:[[1,"desc"],[2,"desc"]],pageLength:25,lengthMenu:[[10,25,50,-1],[10,25,50,"Todos"]],dom:'<"d-flex justify-content-between align-items-center mb-3"<"d-flex align-items-center"l><"d-flex align-items-center"f>>rtip',drawCallback:function(){$('[data-bs-toggle="tooltip"]').tooltip("dispose").tooltip()}});function o(){$(".is-invalid").removeClass("is-invalid"),$(".invalid-feedback").empty()}function r(e){$(`#${e}InformeErrorContainer`).addClass("d-none"),$(`#${e}InformeErrorList`).empty()}function a(e,r=""){o();let a=[];if($.each(e,function(e,o){let n=$(`#${r?`${r}_${e}`:e}`);n.length&&(n.addClass("is-invalid"),n.siblings(".invalid-feedback").html(o[0])),$.each(o,function(e,o){a.push(`<li>${o}</li>`)})}),a.length>0){let e=r||"add";$(`#${e}InformeErrorContainer`).removeClass("d-none"),$(`#${e}InformeErrorList`).html(a.join(""))}}function n(e,o="success"){let r=`\n            <div class="alert ${"success"===o?"alert-success":"alert-danger"} alert-dismissible fade show" role="alert">\n                <i class="fas ${"success"===o?"fa-check-circle":"fa-exclamation-triangle"} me-2"></i>${e}\n                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>\n            </div>\n        `;$("#alert-container").html(r),setTimeout(function(){$(".alert").alert("close")},5e3)}function i(e){$(`#${e}`)[0].reset(),o(),r(e.replace("Form","").replace("Informe",""))}function t(e){let o=!0,r=$(`#${e}`);return r.find("[required]").each(function(){$(this).val()||($(this).addClass("is-invalid"),$(this).siblings(".invalid-feedback").text("Este campo es requerido."),o=!1)}),r.find('input[type="number"]').each(function(){let e=$(this).val(),r=$(this).attr("min");e&&r&&parseFloat(e)<parseFloat(r)&&($(this).addClass("is-invalid"),$(this).siblings(".invalid-feedback").text(`El valor mínimo es ${r}.`),o=!1)}),o}$("#anioFilter, #mesFilter, #grupoFilter, #servicioFilter").on("change",function(){!function(){let o=$("#anioFilter").val(),r=$("#mesFilter").val(),a=$("#grupoFilter").val(),n=$("#servicioFilter").val();e.columns(1).search(o).columns(2).search(r&&["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(r)]||"").columns(3).search(a).columns(6).search(n).draw()}()}),$("#grupo_id").on("change",function(){!function(e,o){const r=$(`#${o}`),a=r.val();r.find("option:not(:first)").remove(),e&&(r.append('<option value="" disabled>Cargando publicadores...</option>'),r.prop("disabled",!0),$.ajax({url:window.informesIndexConfig.usuariosPorGrupoRoute,type:"GET",data:{grupo_id:e},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content"),Accept:"application/json"},success:function(e){r.find("option:not(:first)").remove(),e.success&&e.usuarios?(e.usuarios.forEach(function(e){const o=e.id==a?"selected":"";r.append(`<option value="${e.id}" ${o}>${e.name}</option>`)}),0===e.usuarios.length&&r.append('<option value="" disabled>No hay publicadores en este grupo</option>')):(r.append('<option value="" disabled>Error al cargar publicadores</option>'),n(e.message||"Error al cargar usuarios del grupo","error"))},error:function(e){r.find("option:not(:first)").remove(),r.append('<option value="" disabled>Error al cargar publicadores</option>'),n("Error al cargar usuarios del grupo","error")},complete:function(){r.prop("disabled",!1)}}))}($(this).val(),"user_id")}),$("#addInformeModal").on("shown.bs.modal",function(){i("addInformeForm"),$("#anio").val((new Date).getFullYear())}),$("#editInformeModal").on("shown.bs.modal",function(){$("#edit_servicio_id").focus()}),$("#addInformeForm").on("submit",function(e){if(e.preventDefault(),!t("addInformeForm"))return!1;o(),r("add");let i=$("#saveInformeBtn"),s=i.find(".spinner-border");s.removeClass("d-none"),i.prop("disabled",!0);let d=new FormData(this),l=$('meta[name="csrf-token"]').attr("content");d.append("_token",l),$.ajax({url:window.informesIndexConfig.storeRoute,type:"POST",data:d,processData:!1,contentType:!1,headers:{"X-CSRF-TOKEN":l,Accept:"application/json"},success:function(e){e.success?($("#addInformeModal").modal("hide"),n(e.message,"success"),location.reload()):n(e.message||"Error al crear el informe","error")},error:function(e){var o;if(422===e.status){a(e.responseJSON.errors,"")}else if(419===e.status)n("Token CSRF expirado. Por favor, recarga la página.","error");else{n((null==(o=e.responseJSON)?void 0:o.message)||e.statusText||"Error interno del servidor","error")}},complete:function(){s.addClass("d-none"),i.prop("disabled",!1)}})}),$(document).on("click",".view-informe",function(){let e=$(this).data("informe-id");$.ajax({url:window.informesIndexConfig.showRoute.replace(":id",e),type:"GET",success:function(e){if(e.success){let o=e.informe;$("#view_anio").text(o.anio),$("#view_mes").text(o.nombre_mes),$("#view_usuario").text(o.usuario_nombre),$("#view_grupo").text(o.grupo_nombre),$("#view_servicio").text(o.servicio_nombre),$("#view_participa").text(o.participa_texto),$("#view_cantidad_estudios").text(o.cantidad_estudios||"0"),$("#view_horas").text(o.horas||"-"),$("#view_comentario").text(o.comentario||"-"),$("#view_nota").text(o.nota||"-"),$("#view_congregacion").length&&$("#view_congregacion").text(o.congregacion_nombre),$("#viewInformeModal").modal("show")}else n(e.message||"Error al cargar el informe","error")},error:function(e){var o;n((null==(o=e.responseJSON)?void 0:o.message)||"Error al cargar el informe","error")}})}),$(document).on("click",".edit-informe",function(){let e=$(this).data("informe-id");$.ajax({url:window.informesIndexConfig.editRoute.replace(":id",e),type:"GET",success:function(e){if(e.success){let o=e.informe;const r=["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];$("#edit_informe_id").val(o.id),$("#edit_anio_display").val(o.anio),$("#edit_anio").val(o.anio),$("#edit_mes_display").val(r[o.mes]||o.mes),$("#edit_mes").val(o.mes),$("#edit_grupo_display").val(o.grupo?o.grupo.nombre:"Sin grupo"),$("#edit_grupo_id").val(o.grupo_id),$("#edit_user_display").val(o.usuario?o.usuario.name:"Sin usuario"),$("#edit_user_id").val(o.user_id),$("#edit_servicio_id").val(o.servicio_id),$("#edit_participa").val(o.participa?"1":"0"),$("#edit_cantidad_estudios").val(o.cantidad_estudios),$("#edit_horas").val(o.horas),$("#edit_comentario").val(o.comentario),$("#edit_nota").val(o.nota),$("#editInformeModal").modal("show")}else n(e.message||"Error al cargar el informe","error")},error:function(e){var o;n((null==(o=e.responseJSON)?void 0:o.message)||"Error al cargar el informe","error")}})}),$("#editInformeForm").on("submit",function(i){if(i.preventDefault(),!t("editInformeForm"))return!1;o(),r("edit");let s=$("#updateInformeBtn"),d=s.find(".spinner-border"),l=$("#edit_informe_id").val();d.removeClass("d-none"),s.prop("disabled",!0);let c=$(this).serialize();$.ajax({url:window.informesIndexConfig.updateRoute.replace(":id",l),type:"PUT",data:c,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(o){o.success?($("#editInformeModal").modal("hide"),n(o.message,"success"),o.data&&e&&function(o){const r=["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];let a=e.rows().nodes().toArray().find(function(e){return $(e).find(".edit-informe").data("informe-id")==o.id});if(a){let n=$(a),i=[];i.push(o.id),i.push(o.anio),i.push(r[o.mes]||o.mes),i.push(`<span class="badge bg-dark">${o.grupo_nombre||""}</span>`),i.push(o.usuario_nombre||""),o.participa?i.push('<span class="badge bg-success">Sí</span>'):i.push('<span class="badge bg-danger">No</span>'),i.push(`<span class="badge bg-warning text-dark">${o.servicio_nombre||""}</span>`),(window.informesIndexConfig.isAdmin||window.informesIndexConfig.isSupervisor)&&i.push(`<span class="badge bg-secondary">${o.congregacion_nombre||""}</span>`);let t=`\n                <div class="btn-group" role="group">\n                    <button type="button" class="btn btn-sm btn-info view-informe"\n                            data-informe-id="${o.id}"\n                            data-bs-toggle="tooltip"\n                            title="Ver informe">\n                        <i class="fas fa-eye"></i>\n                    </button>`;window.informesIndexConfig.canModify&&(t+=`\n                    <button type="button" class="btn btn-sm btn-warning edit-informe"\n                            data-informe-id="${o.id}"\n                            data-bs-toggle="tooltip"\n                            title="Editar informe">\n                        <i class="fas fa-edit"></i>\n                    </button>\n                    <button type="button" class="btn btn-sm btn-danger delete-informe"\n                            data-informe-id="${o.id}"\n                            data-informe-name="${o.usuario_nombre} - ${r[o.mes]||o.mes} ${o.anio}"\n                            data-bs-toggle="tooltip"\n                            title="Eliminar informe">\n                        <i class="fas fa-trash"></i>\n                    </button>`),t+="</div>",i.push(t),e.row(n).data(i).draw(!1),$('[data-bs-toggle="tooltip"]').tooltip("dispose").tooltip()}}(o.data)):n(o.message||"Error al actualizar el informe","error")},error:function(e){var o;if(422===e.status){a(e.responseJSON.errors,"edit")}else{n((null==(o=e.responseJSON)?void 0:o.message)||"Error interno del servidor","error")}},complete:function(){d.addClass("d-none"),s.prop("disabled",!1)}})}),$(document).on("click",".delete-informe",function(){let e=$(this).data("informe-id"),o=$(this).data("informe-name");$("#deleteInformeName").text(o),$("#deleteInformeModal").modal("show"),$("#confirmDeleteInformeBtn").data("informe-id",e)}),$("#confirmDeleteInformeBtn").on("click",function(){let o=$(this).data("informe-id"),r=$(this),a=r.find(".spinner-border");a.removeClass("d-none"),r.prop("disabled",!0),$.ajax({url:window.informesIndexConfig.destroyRoute.replace(":id",o),type:"DELETE",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(r){r.success?($("#deleteInformeModal").modal("hide"),n(r.message,"success"),$(`tr[data-informe-id="${o}"]`).fadeOut(300,function(){e.row($(this)).remove().draw()})):n(r.message||"Error al eliminar el informe","error")},error:function(e){var o;n((null==(o=e.responseJSON)?void 0:o.message)||"Error al eliminar el informe","error")},complete:function(){a.addClass("d-none"),r.prop("disabled",!1)}})}),$('[data-bs-toggle="tooltip"]').tooltip(),$("#addInformeModal, #editInformeModal").on("hidden.bs.modal",function(){i($(this).attr("id").replace("Modal","Form"))}),$("#addInformeForm input, #addInformeForm select, #editInformeForm input, #editInformeForm select").on("change blur",function(){$(this).hasClass("is-invalid")&&($(this).removeClass("is-invalid"),$(this).siblings(".invalid-feedback").empty())}),$("#informesTable_filter input").on("keyup",function(){this.value.toLowerCase().length>0&&$("#anioFilter, #mesFilter, #usuarioFilter, #grupoFilter, #servicioFilter, #participaFilter, #congregacionFilter").val("")}),$("#informesTable_filter input").on("keyup",function(){""===this.value&&($("#anioFilter, #mesFilter, #usuarioFilter, #grupoFilter, #servicioFilter, #participaFilter, #congregacionFilter").val(""),e.search("").columns().search("").draw())}),window.exportInformes=function(e){}}),$("#verInformesModal").on("show.bs.modal",function(){$("#grupoFilterModal").val(""),$("#informesGrupoTableBody").empty(),$("#informesGrupoContainer").addClass("d-none"),$("#noDataMessage").removeClass("d-none").html('<i class="fas fa-info-circle me-2"></i>Seleccione un periodo y grupo para ver los informes.'),$.ajax({url:window.informesIndexConfig.periodosRoute,type:"GET",success:function(e){if(e.success){let o=$("#periodoFilterModal");o.empty(),o.append('<option value="">Seleccione un periodo</option>');const r=["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];e.periodos.forEach(function(e){let a=`${r[e.mes]||e.mes} ${e.anio}`;o.append(`<option value="${e.anio}-${e.mes}">${a}</option>`)}),e.periodos.length>0&&o.val(`${e.periodos[0].anio}-${e.periodos[0].mes}`)}},error:function(e){console.error("Error al cargar periodos:",e)}})}),$("#periodoFilterModal, #grupoFilterModal").on("change",function(){!function(){let e=$("#periodoFilterModal").val(),o=$("#grupoFilterModal").val();if(!e||!o)return $("#informesGrupoContainer").addClass("d-none"),void $("#noDataMessage").removeClass("d-none");let[r,a]=e.split("-");$.ajax({url:window.informesIndexConfig.informesPorGrupoRoute,type:"GET",data:{grupo_id:o,anio:r,mes:a},success:function(e){e.success&&function(e){if(0===e.length)return $("#informesGrupoContainer").addClass("d-none"),void $("#noDataMessage").removeClass("d-none").html('<i class="fas fa-info-circle me-2"></i>No hay usuarios en el grupo seleccionado.');$("#noDataMessage").addClass("d-none"),$("#informesGrupoContainer").removeClass("d-none");let o=$("#informesGrupoTableBody");o.empty(),e.forEach(function(e){let r=1==e.participa?'<i class="fas fa-check-square text-success" title="Participa"></i>':'<i class="fas fa-times text-danger" title="No participa"></i>',a=`\n            <tr>\n                <td>${e.nombre}</td>\n                <td class="text-center">${r}</td>\n                <td>${e.servicio_nombre}</td>\n                <td class="text-center">${e.cantidad_estudios}</td>\n                <td class="text-center">${e.horas}</td>\n                <td>${e.comentario}</td>\n            </tr>\n        `;o.append(a)})}(e.data)},error:function(e){console.error("Error al cargar informes:",e),showAlert("Error al cargar los informes","danger")}})}()}),$("#informeCongregacionModal").on("show.bs.modal",function(){$.ajax({url:window.informesIndexConfig.periodosRoute,method:"GET",success:function(o){if(o.success){let r=$("#periodoFilterCongregacion");r.empty(),r.append('<option value="">Seleccione un periodo</option>');const a=["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];o.periodos.forEach(function(e){let o=a[e.mes]||e.mes,n=`${e.anio}-${e.mes}`,i=`${o} ${e.anio}`;r.append(`<option value="${n}">${i}</option>`)}),o.periodos.length>0&&(r.val(`${o.periodos[0].anio}-${o.periodos[0].mes}`),e())}},error:function(){console.error("Error al cargar periodos")}})}),$("#periodoFilterCongregacion").on("change",function(){e()});const o=document.getElementById("registroPublicadorModal");function r(){let e=$("#registroAnioFilter").val(),o=$("#registroPublicadorFilter").val();if(!e||!o)return $("#registroPublicadorInfo").addClass("d-none"),$("#registroPublicadorContainer").addClass("d-none"),$("#noDataRegistroMessage").removeClass("d-none"),void $("#loadingRegistroPublicador").addClass("d-none");$("#loadingRegistroPublicador").removeClass("d-none"),$("#registroPublicadorInfo").addClass("d-none"),$("#registroPublicadorContainer").addClass("d-none"),$("#noDataRegistroMessage").addClass("d-none"),$.ajax({url:window.informesIndexConfig.registroPublicadorRoute,method:"GET",data:{anio:e,user_id:o},success:function(r){if($("#loadingRegistroPublicador").addClass("d-none"),r.success){$("#registroPublicadorTable thead th:first-child").text(`Año de servicio ${e}`),$("#tab-anio-actual-text").text(e);let a=parseInt(e)-1;$("#tab-anio-anterior-text").text(a);let n=r.user_info;$("#info_nombre").text(n.nombre),$("#info_fecha_nacimiento").text(n.fecha_nacimiento),$("#info_fecha_bautismo").text(n.fecha_bautismo),$("#info_hombre").prop("checked",1==n.sexo),$("#info_mujer").prop("checked",2==n.sexo),$("#info_ungido").prop("checked",1==n.esperanza),$("#info_otras_ovejas").prop("checked",2==n.esperanza),$("#info_anciano").prop("checked",n.es_anciano),$("#info_siervo").prop("checked",n.es_siervo),$("#info_precursor_regular").prop("checked",n.es_precursor_regular),$("#info_precursor_especial").prop("checked",n.es_precursor_especial),$("#info_misionero").prop("checked",n.es_misionero),$("#registroPublicadorInfo").removeClass("d-none");let i=$("#registroPublicadorTableBody");i.empty(),r.registro.forEach(function(e){let o="<tr";"Total"===e.mes_nombre&&(o+=' class="table-secondary fw-bold"'),o+=">",o+=`<td>${e.mes_nombre}</td>`,"Total"===e.mes_nombre?o+="<td></td>":(o+='<td class="text-center">',1==e.participa?o+='<input type="checkbox" checked disabled>':o+='<input type="checkbox" disabled>',o+="</td>"),o+=`<td class="text-center">${e.cantidad_estudios>0?e.cantidad_estudios:""}</td>`,"Total"===e.mes_nombre?o+="<td></td>":(o+='<td class="text-center">',1==e.es_precursor_auxiliar?o+='<input type="checkbox" checked disabled>':o+='<input type="checkbox" disabled>',o+="</td>"),o+=`<td class="text-center">${null!==e.horas&&e.horas>0?e.horas:""}</td>`,o+=`<td>${e.nota||""}</td>`,o+="</tr>",i.append(o)}),$("#tab-anio-actual").tab("show"),$("#registroPublicadorContainer").removeClass("d-none"),$("#noDataRegistroMessage").addClass("d-none"),function(e,o){let r=parseInt(e)-1;$("#registroPublicadorTableAnterior thead th:first-child").text(`Año de servicio ${r}`),$.ajax({url:window.informesIndexConfig.registroPublicadorRoute,method:"GET",data:{anio:r,user_id:o},success:function(e){if(e.success){let o=$("#registroPublicadorTableAnteriorBody");o.empty(),e.registro.forEach(function(e){let r="<tr";"Total"===e.mes_nombre&&(r+=' class="table-secondary fw-bold"'),r+=">",r+=`<td>${e.mes_nombre}</td>`,"Total"===e.mes_nombre?r+="<td></td>":(r+='<td class="text-center">',1==e.participa?r+='<input type="checkbox" checked disabled>':r+='<input type="checkbox" disabled>',r+="</td>"),r+=`<td class="text-center">${e.cantidad_estudios>0?e.cantidad_estudios:""}</td>`,"Total"===e.mes_nombre?r+="<td></td>":(r+='<td class="text-center">',1==e.es_precursor_auxiliar?r+='<input type="checkbox" checked disabled>':r+='<input type="checkbox" disabled>',r+="</td>"),r+=`<td class="text-center">${null!==e.horas&&e.horas>0?e.horas:""}</td>`,r+=`<td>${e.nota||""}</td>`,r+="</tr>",o.append(r)})}else{let e=$("#registroPublicadorTableAnteriorBody");e.empty(),e.append('<tr><td colspan="6" class="text-center text-muted">No hay datos disponibles para el año '+r+"</td></tr>")}},error:function(e){let o=$("#registroPublicadorTableAnteriorBody");o.empty(),o.append('<tr><td colspan="6" class="text-center text-danger">Error al cargar datos del año '+r+"</td></tr>")}})}(e,o)}else $("#noDataRegistroMessage").removeClass("d-none").html('<i class="fas fa-exclamation-circle me-2"></i>'+(r.message||"No se pudo cargar el registro."))},error:function(e){$("#loadingRegistroPublicador").addClass("d-none"),$("#noDataRegistroMessage").removeClass("d-none").html('<i class="fas fa-exclamation-triangle me-2"></i>Error al cargar el registro.')}})}o&&o.addEventListener("show.bs.modal",function(){!function(){let e=$("#registroAnioFilter");if(0===e.length)return void console.error("El select registroAnioFilter no existe en el DOM");e.empty(),e.append('<option value="">Seleccione un año</option>');let o,r=new Date,a=r.getMonth()+1,n=r.getFullYear();o=a>=9?n+1:n;$.ajax({url:window.informesIndexConfig.aniosRegistroRoute,method:"GET",success:function(r){let a=[];r.success&&r.anios&&r.anios.length>0&&(a=r.anios),a.includes(o)||(a.unshift(o),a.sort((e,o)=>o-e)),a.forEach(function(o){e.append(`<option value="${o}">${o}</option>`)}),e.val(o),console.log("Años cargados correctamente, año seleccionado:",o)},error:function(){console.error("Error al cargar años de informes"),e.append(`<option value="${o}">${o}</option>`),e.val(o)}})}(),$("#registroGrupoFilter").val(""),$("#registroPublicadorFilter").empty().append('<option value="">Seleccione un publicador</option>'),$("#registroPublicadorInfo").addClass("d-none"),$("#registroPublicadorContainer").addClass("d-none"),$("#noDataRegistroMessage").removeClass("d-none")}),$("#registroGrupoFilter").on("change",function(){let e=$(this).val(),o=$("#registroPublicadorFilter");o.empty().append('<option value="">Seleccione un publicador</option>'),$("#registroPublicadorInfo").addClass("d-none"),$("#registroPublicadorContainer").addClass("d-none"),$("#noDataRegistroMessage").removeClass("d-none"),e?($("#btnExportarPDF").prop("disabled",!1),$.ajax({url:window.informesIndexConfig.usuariosPorGrupoRoute,method:"GET",data:{grupo_id:e},success:function(e){e.success&&e.usuarios&&e.usuarios.forEach(function(e){o.append(`<option value="${e.id}">${e.name}</option>`)})},error:function(){console.error("Error al cargar usuarios")}})):$("#btnExportarPDF").prop("disabled",!0)}),$("#registroPublicadorFilter").on("change",function(){if($(this).val())$("#btnExportarPDF").prop("disabled",!1);else{let e=$("#registroGrupoFilter").val();$("#btnExportarPDF").prop("disabled",!e)}r()}),$("#registroAnioFilter").on("change",function(){$("#registroPublicadorFilter").val()&&r()}),$("#btnExportarPDF").on("click",function(){let e=$("#registroAnioFilter").val(),o=$("#registroGrupoFilter").val(),r=$("#registroPublicadorFilter").val();if(!e)return void alert("Debe seleccionar un año");let a=window.informesIndexConfig.exportarRegistroPDFRoute+"?anio="+e;r?a+="&user_id="+r:o&&(a+="&grupo_id="+o),window.open(a,"_blank")});
